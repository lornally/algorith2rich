> 信达雅, 后两条臣妾做不到, 第一条, 臣妾尽量, 译者: 减肥食铁兽-茂弘 2013.11.15

### 一个高效的旅行商(TSP)问题的启发式解法

> S.lin and B.W.Kernighan
> 贝尔实验室, 新泽西州毛利山
> 1975.10.15

本文讨论了一种高效的启发式程序，可得旅行商问题的最优解和近优解。 该方法在组合优化问题中具有广泛的适用性和一般性。 该程序的测试用例包含: “经典”测试集以及随机生成的测试集（最多 110 个城市）。 运行时间大约随着 $n^2$ 增长； 对于100 个城市来说, 最好的情况下需要不到 25 秒（GE635）， 一般情况, 95% 置信解需要3分钟

==对称旅行商问题==：已知 n 个城市之间距离, 这些距离是一个对称的n*n矩阵，找到一个最短回路，可以恰好访问每个城市一次。 当然，除了空间距离最短之外，还很可能是其他概念距离，例如时间距离、成本距离等。 这个问题已经研究了很多年，精确的算法需要较长的运行时间； 启发式方法可以在合理的时间内为较大的问题提供良好的答案，但不能保证会出现最佳答案。 已有的启发式方法，随着 n 的增加，运行时间会迅速增加，因此几乎没有超过 60 个城市的实用解。
	例如，HELD & KARP 最近的工作给出了一种解决问题的方法(最小生成树mst), 正是在合理的时间内解决某一类旅行商问题。 然而，如果特定问题不属于此类，则必须通过添加机制（在本例中为分支定界branch and bound）来补充该过程，并且运行时间通常会令人望而却步。 他们报告的最大测试集是 64 个城市。

​	KROLAK 等人采取了一种完全不同的方法。他们使用几种快速、简单且效率较低的启发式方法来获得良好的解决方案，然后将人类判断应用于游览图片（“人机交互”）以尝试最佳解决方案。 虽然这种方法已应用于大型问题（200 个城市），但耗时（尤其是人工时间）成本高昂，而且结果通常不是最优的。 （我们已经改进了五个 100 城市中的三个。）此外，无法用于非二维欧式空间.

​	本文讨论了一种新的启发式方法，可以快速生成解决方案, 时间开销大约为 n^2^。 程序基于通用启发法, 此法拥有广泛的适用性。 它已经在图划分方面取得了相当大的成功。(注: 图划分问题:  给定点集S上的图, 找到与 S-T 最小连接的节点 T 的子集，并且满足 T 和 S-T 具有相同节点数的约束。 图划分问题包含最大割/最小割问题)

在这篇论文中，我们集中讨论它在旅行商问题上的应用。 我们将讨论启发式过程中涉及的基本原理，并通过多个案例来说明其有效性.

​	许多组合优化问题（例如图划分和旅行商问题）可以抽象地表述为: 

* 从集合S中查找子集T
  * T 是满足约束C
  * 并最优化目标函数 f
* 例如，在旅行商问题中，
  * 我们必须从所有边的集合中找到
  * 形成回路
  * 且具有最小长度的子集。

​	对于大多数此类问题，所有已知算法都需要随 n 呈指数增长的计算时间。 复杂性理论研究表明旅行商问题是一个NP问题(无多项式时间解), 因此启发式方法似乎是唯一实际可行解(数值解)。 从理论角度来看，虽然我们不能普遍证明解的最优性，但我们可以获得统计置信度； 对于实际应用，通常最重要的是在可行的运行时间内获得良好的答案。

组合优化问题的启发式解有个基本方法: 

* 可行解

  * 随机选择 
  * 迭代改进

* 例如如下的步骤: 

  1. 生成伪随机可行解，即满足C约束的集合T。 (随机选择)
  1. 尝试通过对 T 进行某种变换来找到改进的可行解 T'。 (迭代改进, 爬山, 局部最优)
  1. 如果找到改进的解，即 f(T') <f(T)，则将 T 替换为 T'，并从步骤 2 开始重复。 (持续迭代)
  1. 如果找不到改进的解，则T 是局部最优解。 从步骤 1 开始重复，直到计算时间用完，或者答案令人满意。 (再次随机选择, 跳出局部最优)

​	实际的启发式过程（例如步骤2的转换）将步骤1的随机解对应到到局部最优解，由此全局最优解有望出现。 启发式越好，局部最优解的集合就越小，全局最优值出现的概率越高。 在步骤 1 中选择随机均匀分布初始值, 而不是好的值，除非我们事先知道某定值会易于得到正解。 选随机初始值有两个理由: 

1. 优秀的启发式方法本身, 就可以快速的从随机值得到好的中间值, 像任何启动程序得到好的初始值的速度一样快. --- 我们的经验。 
2. 启动程序得到好的初始值通常是确定的值，因此可能无法获得足够多, 分布足够广泛的初始值, 以至于得到的局部最优解的优秀程度不够(不是最高的山峰)

​	当然，迭代过程的核心是步骤 2，即尝试迭代改进解。 此时我们可以使用一个: 将来自T的固定数量的k个元素与来自S-T的k个元素进行交换，使得所得到的解决方案T'是可行且更好的。只要可以找到这样的组，就会重复此过程。 最终这种交换不再进一步提高 T，此时我们就有了局部最优解。 显然, 这里的问题是: 找到正确的组, 通过交换他们即可优化解.

​	这种交换策略被 CROES（2opt, k=2）和 LIN（3opt, k=3）应用于旅行商问题，取得了相当大的成功. 但必须提前指定 k 的值是一个严重的缺点。 计算量随着 k 的增加而迅速增加，并且很难提前知道使用什么 k 作为运行时间和解决方案质量之间的最佳折衷方案。

​	我们的启发式方法是交换变换的变种。 假设 T 是一个非最优但可行的解决方案。 那么我们可以说 T 不是最优的，因为 T 中有 k 个元素$x_1,..., x_k$ 是“错位的”； 为了使 T 最优，它们应该被 S-T 的 k 个元素 $y_1, ..., y_k$代替。 问题只是确定 k 以及 x's 和 y's。 (本问题域, x和y都是边, ~~~mck)

​	由于我们不知道 k 应该是多少，所以很容易想到一个肤浅的方案: 固定 k 然后考虑 T 的所有可能的 k 子集。 反之，我们尝试尽可能逐个元素地找到 k 和$x_1,..., x_k$ 和$y_1, ..., y_k$ 。 因此，我们首先尝试识别“最错位”的对x~i~和y~i~；选择 x~i~y~i~ 并暂时放在一边，然后, 我们继续寻找, 找到 x~2~ 和 Y~2~，即剩余集合中最错位对； 等等。 更正式地说：

1. 生成随机初始解T。
2. (a) 设 i = 1。
   (b) 选择 x~i~ 和 y~i~ 作为第 i 步中最错位的对。 这通常意味着改进会最大化, 发生在交换 T 中$x_1,..., x_k$ 和S-T中的 $y_1, ..., y_k$
   (c) 如果看起来无法再获得更多收益，则根据适当的停止规则，转至步骤 3； 否则，设i=i+1并返回步骤2(b)。
3. 如果找到i=k的最佳改进，则将$x_1,..., x_k$ 和$y_1, ..., y_k$ 交换，得到新的T，并转至步骤2； 如果没有发现改善，请转至步骤 4。
4. 如果需要，请重复步骤 1。

​	为了实现这项工作，显然我们需要做几件事：

1. 我们需要一个选择规则，快速有效地告诉我们哪对当前最错位，因为任何阶段的错误都可能会摧毁后期阶段取得好结果的所有希望。
2. 我们需要一个简单的函数来表示一组交换的总收益。 假设 g~i~是与 x~i~ 和 y~i~ 交换相关的收益，此时 x~1~, y~1~, ..., x~i-1~, y~i-1~ 已被选择。则 $x_1,..., x_k$ 和$y_1, ..., y_k$ 交换的增益为$g_1+ ... +g_k$，此处有意义的性质是: 增益是相加的。
   考虑到这种可加性，当某些 g~i~ 为负时，选择过程不需要立即停止； 事实上，对于所有的k而言, 只有当 $\sum_{i=1}^{i=k}{g_i} \leq 0 $ 时我们才需要停止。 这有助于跳出局部最优解
3. 如果我们要能够对任意k停止选择过程, 开始交换 $x_1,..., x_k$ 和$y_1, ..., y_k$ . 我们必须知道交换是可行的，即得到的解决方案 满足约束 C。因此，我们要求（对于大多数 k）每个需计算的交换都使我们处于可行状态。 首先，这使我们免于数据记录问题，其次，我们不必费尽心思交换集合，却得到无效解。
4. 需要一个停止规则来告诉我们，寻找元素进行交换不可能再有收益，或者至少已经达到了收益递减的地步。 此处需要平衡, 可能花了大量的时间却没有收益(乐观贪婪), 也可能早早放弃导致结果不够好(悲观懒惰)
5. 最后, 我们需要 $x_1,..., x_k$ 和$y_1, ..., y_k$ 不相交, 一旦元素以一种方式移动，则在本次迭代期间不会再次移动回来。 （下一轮交换, 它很可能会回来）这在很大程度上是实用的 -- 它避免了各种微妙的实现错误，减少了运行时间，简化了增益函数，并提供了有效的停止规则。

在我们测算待交换序列 $x_1,..., x_m$ 和$y_1, ..., y_m$ 的增益为$g_1, ..., g_m$时，此时真正要交换的集合(k)的收益($g_1+ ... +g_k$ )是最大值（并且可行）。 如果这是一个改进，则交换此集合形成解决方案T，并且从这个新的起点迭代该过程。 

最终我们到达($g_1+ ... +g_k$ ) 始终为零或负值的点。 这表明该过程无法进行进一步的改进，因此此时的解决方案是我们的局部最优解。 

尽管在上面的讨论中我们假设每个可行集都具有相同的基数，但基本思想可以很容易地适应不定尺度的T 和 S-T 。